<html>
    <head>
        <title>
            dmulog.in
        </title>
        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lora">
        <link rel="stylesheet" href="/media/css/base.css">
        <link rel="stylesheet" href="/media/css/monokai.css">
    </head>
    <body>
        <div id="entire_page" class="page">
            <div id="header" class="header">
                <a id="homelink" class="homelink" href="/">Dipanjan Mukherjee</a> 

                <a id="toplink-1" class="toplink right"
                    href="http://github.com/schatten/">projects</a>
                <a id="toplink-2" class="toplink right"
                    href="/pages/resume">resume</a>
                <a id="toplink-2" class="toplink right"
                    href="/pages/about">about</a>
            </div>

            <hr class="deepbottom">
            
            <div id="post" class="post">
                    <a href="/archive/3.html" class="post-title">A simple proxy servlet for GWT devmode</a>

                <span class="post-date">May, 2011</span>
                <div id="post-contents" class="post-contents">
                    <p>Disclosure: The source code and some other ideas are from one of 
<a href="http://kennethjorgensen.com/blog/2010/04/12/proxy-servlet-for-gwt-in-devmode/">Kenneth Jorgensen's blog post</a></p>
<p>As you start developing with the Google Web Toolkit, you may find yourself
stuck because of the <a href="http://en.wikipedia.org/wiki/Same_origin_policy">"Same Origin Policy"</a> restrictions that browser
developers have implemented. </p>
<p>The SOP restricts scripts running on the browser from placing
XmlHTTPRequests to hosts other than the host from which the current page 
was requested. This is a short, possibly imprecise definition. What really
matters is that if you develop your server-side API in a language other than
Java, you will have trouble accessing that API while in devmode.</p>
<p>What you can do is, use a language-agnostic servlet that runs on the GWT 
development mode server and proxies your requests to another server.<br />
</p>
<p>I won't dump the entire java servlet file here. You can find a link
<a href="/media/resources/ProxyServlet.java">here</a>. There is a dirty hack in the servlet; I describe it later. </p>
<p>To make this work, you have to edit the web.xml file within the
WEB-INF directory within the war directory not the *.gwt.xml file.
As far as I understand, (I am a noob to GWT) the *.gwt.xml file is
to be updated with the details of a servlet when you use GWT-RPC.</p>
<p>Here is a snapshot of my web.xml.</p><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE web-app</span>
<span class="cp">    PUBLIC &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;</span>
<span class="cp">    &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot;&gt;</span>

<span class="nt">&lt;web-app&gt;</span>
    <span class="nt">&lt;servlet&gt;</span>
        <span class="nt">&lt;servlet-name&gt;</span>proxy<span class="nt">&lt;/servlet-name&gt;</span>
        <span class="nt">&lt;servlet-class&gt;</span>in.dmulog.gwt.ProxyServlet<span class="nt">&lt;/servlet-class&gt;</span>
    <span class="nt">&lt;/servlet&gt;</span>
    <span class="nt">&lt;servlet-mapping&gt;</span>
        <span class="nt">&lt;servlet-name&gt;</span>proxy<span class="nt">&lt;/servlet-name&gt;</span>
        <span class="nt">&lt;url-pattern&gt;</span>/proxy/*<span class="nt">&lt;/url-pattern&gt;</span>
    <span class="nt">&lt;/servlet-mapping&gt;</span>
    <span class="c">&lt;!-- Default page to serve --&gt;</span>
    <span class="nt">&lt;welcome-file-list&gt;</span>
        <span class="nt">&lt;welcome-file&gt;</span>Client.html<span class="nt">&lt;/welcome-file&gt;</span>
    <span class="nt">&lt;/welcome-file-list&gt;</span>
<span class="nt">&lt;/web-app&gt;</span>
</pre></div>
<p>Now, if you update the code according to your own setup, any
requests at <span class="inline_code">localhost:8888/proxy/this/uri</span> will be forwarded to
<span class="inline_code">localhost:8000/this/uri</span>. Or as the case may be. You can define all
this in the java servlet file. </p>
<p>Now about the dirty hack I talked about. Within the java file, line
number 68 reads:</p><div class="highlight"><pre><span class="n">uri</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">req</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">().</span><span class="na">substring</span><span class="o">(</span><span class="mi">6</span><span class="o">));</span>
</pre></div>
<p>What the substring part does is converts
<span class="inline_code">localhost:8888/proxy/foo/bar/baz</span> to a request to
<span class="inline_code">localhost:8000/foo/bar/baz</span>. </p>
<p>If we don't use the substring hack, it remains as a request to
<span class="inline_code">localhost:8000/<strong>proxy</strong>/foo/bar/baz</span> which might not be useful in
your case. You can possibly do this better with splitting the string
and joining. But hey, I said it was dirty. </p>
<p>Happy coding.</p>
                </div>
            </div>
            <hr class="deepbottom">
            <div id="post" class="post">
                    <a href="/archive/2.html" class="post-title">WebDev Selection Test</a>

                <span class="post-date">October, 2010</span>
                <div id="post-contents" class="post-contents">
                    <p>I had to select a few developers to work with me at developing the <a href="http://www.ecell-iitkgp.org">ecell website</a> further. 
There are many loose ends to tie up. However, working out a selection procedure was in itself
a mammoth task. I had to try to keep the technicalities to a minimum, focus on logic and interest, 
both of which are difficult to cardinalize. I came up with a solution, with help from Sid who selected
me in my first year. Test them on fundamentals which are not bound to any language/framework in particular.
Logical tests and some database concepts. The common element in all these would-be questions was that they
had left me amazed when I discovered the answers. </p>
<p>Here is the paper.</p>
<iframe width=100% height=560px frameborder=0 src=https://docs.google.com/gview?a=v&pid=explorer&chrome=false&api=true&embedded=true&srcid=0BxG0waWYlVh4YjlhZGMxZDktYTQ1Mi00MDZlLTk5MGQtNDg3OWY4ZWI4YjM1&hl=en></iframe>

<h2>Discussion:</h2>
<p>Question 1:</p>
<p>Concentrating on the relationship between the books and authors is the key point in this question.
In one particular solution, there are 3 tables. One representing the authors. another for the books
and a third one for the relationship. This table is often called a linker table.</p>
<img src="/media/im/web-selections-db.png">

<p>As is clearly visible, the linker table takes the pk (primary key:a unique identifier) of a book and 
a pk of the author and connects the two in a manner which limits the number of columns : A key requirement
in a database schema.</p>
<p>Question 2:</p>
<p>The flaw in this code snippet is that the /astra url will never be reached. This is because the line
immediately above it captures all urls which begin with /a (including /astra) and the control never reaches 
the /astra line. One way to circumvent this is to swap the two lines. This way, the condition is avoided.</p>
<p>Question 3:</p>
<p>We could use javascript to preload the images. This is the easy way out and works most of the time. I agree this
involves prior knowledge of this feature. But infact, there is another way : Sprites.
Assume you have the case as mentioned in the question. A rollover button. You have one image. When you move the mouse
over the image, it changes. Assume the images are both 40x20 in size. Now you can compose an image of 40x40 size 
containing both the images in two halves. Then using the CSS property of background-position, you can easily shift the image
at the required event. This is a sure-shot method since there is only one image and will have been downloaded completely
if it is being displayed at all. I agree, this question does require
prior knowledge as well. But people who are interested should have
some advantages; right?</p>
<p>Question 4:</p>
<p>This question was indeed a tough one. <a href="http://www.yeban.in">Anurag</a> came up with it. The question has many answers. Maybe I will ask him 
to come up with his own some day. For now, you are stuck with my version of it. So here goes.</p>
<p>One way is to fetch different kinds of data from different fine-tuned servers (think Content Delivery Networks). For
example, images could be fetched from a server running Nginx which is one of the fastest static content servers
I have seen. Also, some form of load-balancing server could be used to distribute the load across multiple servers.
This answers both the cases of scalability and optimisation.</p>
<p>Another method could be to use redundant data-servers across diverse geographical locations.</p>
                </div>
            </div>
            <hr class="deepbottom">
            <div id="post" class="post">
                    <a href="/archive/1.html" class="post-title">MarkDir : persistence in terminals without multiplexers or tabs</a>

                <span class="post-date">September, 2010</span>
                <div id="post-contents" class="post-contents">
                    <p>This post describes how you can open new terminals which are already on a directory of your choice.</p>
<p>I use the <a href="http://www.vim.org">Vim</a> text editor. But I find the keybindings for its multiple windows quite cumbersome.
Also, I use the <a href="http://awesome.naquadah.org">awesome</a> window manager. Opening terminals in this wm is incredibly easy. Often, 
I use multiple terminal windows to edit code at the same time. To save me from having to keep cd-ing 
into my projects over and over again, I wrote this "tiny" shell function.</p><div class="highlight"><pre><span class="c"># ===================== Mark functions =======================</span>
<span class="c"># calling mark, sets up a file ~/.mark_dir containing</span>
<span class="c"># the value of the current directory</span>
<span class="c"># hence forth, any terminal you open will be directed to this</span>
<span class="c"># directory</span>
<span class="k">function </span>m<span class="o">(){</span>
    <span class="nb">printf</span> <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span> &gt; ~/.mark_dir
    <span class="nb">echo</span> <span class="s1">&#39;Directory Marked&#39;</span>
<span class="o">}</span>
<span class="c"># to turn this off, call unmark or call mark on some other directory</span>
<span class="c"># unmark resets mark_dir to the home directory and also places you at ~</span>
<span class="k">function </span>u<span class="o">(){</span>
    <span class="nb">printf</span> ~ &gt; ~/.mark_dir
    <span class="nb">echo</span> <span class="s1">&#39;Directory Marked Reset to home&#39;</span>
    <span class="nb">cd</span> ~
<span class="o">}</span>
<span class="nb">read </span>MARKDIR &lt; ~/.mark_dir
<span class="nb">cd</span> <span class="nv">$MARKDIR</span>

<span class="c"># ===================== End Mark functions ===================</span>
</pre></div>
<p>The comments are self explanatory. If you are not feeling like reading code, just paste this code
into your ~/.bashrc or ~/.zshrc. It works fine on my zsh. Should work like wise on any other shell.</p>
<p>Quick Walkthrough</p>
<ol>
<li>type "touch ~/.mark_dir" at the terminal. You need to do this only
    the first time you install the shell function.</li>
<li>when you are at your project dir, just enter 'm' at the terminal. this
    will mark this directory and cd into it every time you open a new terminal</li>
<li>if you are done with this project, just type 'u'. This will remove
    the directory marker and take you to the home directory as well.</li>
</ol>
<p>Nifty, right?</p>
                </div>
            </div>
            <hr class="deepbottom">

            <div id="directors" class="directors">
                <a href="index" class="left footlink">newer</a>
                <a href="" class="right footlink"></a>
            </div>


            <div id="footer" class="footer">
                <span class="foot-notice">
                  <a rel="license"
                    href="http://creativecommons.org/licenses/by-sa/3.0/"><img
                    alt="Creative Commons License"
                    style="border-width:0"
                    src="http://i.creativecommons.org/l/by-sa/3.0/80x15.png"
                    /></a>
                </span>
                <span class="foot-notice">
                </span>
            </div>
        </div>
    </body>
</html>
